{"version":3,"sources":["webpack:///./src/pagecomponents/SpecialPage/SpecialPage.tsx"],"names":["SpecialPageTemplate","_React$Component","props","call","this","prototype","render","_this","page","data","categories","nestCategories","edges","map","e","node","stories","cat","frontmatter","c","getCategory","tags","tagNodes","n","t","find","tag","slug","header","url","description","type","title","name","image","updated_time","updatedate","publish_time","date","react__WEBPACK_IMPORTED_MODULE_2___default","a","createElement","_components_Layout_ContentLayout__WEBPACK_IMPORTED_MODULE_3__","sidebar","_components_SideBar_SideBar__WEBPACK_IMPORTED_MODULE_4__","isFixed","sidebarFixed","i","key","mapSidebarComponent","categoryBar","postheader","_components_Post_PostHeader__WEBPACK_IMPORTED_MODULE_5__","commentCnt","fields","author","context","className","_components_Content_Content__WEBPACK_IMPORTED_MODULE_6__","html","htmlAst","subscriberContent","length","_components_ContentFooter_SubscriberFooter__WEBPACK_IMPORTED_MODULE_8__","content","comments","_components_ContentFooter_CommentFooter__WEBPACK_IMPORTED_MODULE_9__","footer","mapFooterComponent","avatar","React","Component","Page","_ref","pageContext","location","pageQuery"],"mappings":"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","file":"component---src-pagecomponents-special-page-special-page-tsx-c777d324b945dd578242.js","sourcesContent":["import { graphql } from \"gatsby\";\r\nimport React from \"react\";\r\nimport { IQueryArrayResult, ICategory, IAuthor, IComment, ISpecialPage, ICustomerStory, IGatsbyLocation, ITag } from '../../interfaces';\r\nimport { ContentLayoutWithSidebar } from \"../../components/Layout/ContentLayout\";\r\nimport { SideBar } from \"../../components/SideBar/SideBar\";\r\nimport { PostHeader } from \"../../components/Post/PostHeader\";\r\nimport { ReactHTMLContent } from \"../../components/Content/Content\";\r\nimport { getCategory, mapSidebarComponent, mapFooterComponent, nestCategories } from '../../tool';\r\nimport { SubscriberFooter } from \"../../components/ContentFooter/SubscriberFooter\";\r\nimport { CommentFooter } from \"../../components/ContentFooter/CommentFooter\";\r\nimport { IHeaderProps } from \"../../components/Layout/Header\";\r\n\r\ninterface IQueryResult\r\n{\r\n  data: {\r\n    categories: IQueryArrayResult<ICategory>;\r\n    page: ISpecialPage,\r\n    comments: IQueryArrayResult<IComment>;\r\n    avatar: any;\r\n    stories: IQueryArrayResult<ICustomerStory>;\r\n    tags: IQueryArrayResult<ITag>;\r\n    image: any;\r\n  }\r\n  context: {\r\n    author: IAuthor;\r\n    comments: IComment[];\r\n  }\r\n  location: IGatsbyLocation;\r\n}\r\n\r\nexport class SpecialPageTemplate extends React.Component<IQueryResult>\r\n{\r\n  constructor(props)\r\n  {\r\n    super(props);\r\n  }\r\n  render()\r\n  {\r\n    let page = this.props.data.page;\r\n    let categories = nestCategories(this.props.data.categories.edges.map(e => e.node));\r\n    let stories = this.props.data.stories.edges.map(e => e.node);\r\n    let cat = page.frontmatter.categories.map(c => getCategory(c, categories));\r\n    let tags: ITag[] = null;\r\n    if(page.frontmatter.tags)\r\n    {\r\n      let tagNodes = this.props.data.tags.edges.map(n => n.node);\r\n      tags = page.frontmatter.tags.map(t => tagNodes.find(tag => tag.slug == t));\r\n    }\r\n\r\n    let header: IHeaderProps = {\r\n      url: page.frontmatter.slug,\r\n      description: page.frontmatter.description,\r\n      type: \"article\",\r\n      title: page.frontmatter.title,\r\n      tags: tags.map(t => t.name),\r\n      image: page.frontmatter.image,\r\n      updated_time: page.frontmatter.updatedate,\r\n      publish_time: page.frontmatter.date\r\n    }\r\n\r\n    return (\r\n      <ContentLayoutWithSidebar \r\n        sidebar={(\r\n          <SideBar isFixed={this.props.data.page.frontmatter.sidebarFixed}>\r\n            {\r\n              page.frontmatter.sidebar.map((c,i) => (\r\n                <div key={i}>\r\n                  {\r\n                    mapSidebarComponent(c, page)\r\n                  }\r\n                </div>\r\n              ))\r\n            }          \r\n          </SideBar>\r\n        )}\r\n        categoryBar={null}\r\n        header={header}\r\n      >\r\n      {\r\n        page.frontmatter.postheader === true ? <PostHeader frontmatter={page.frontmatter} commentCnt={page.fields.commentCnt} author={this.props.context.author} categories={cat} /> : \"\"\r\n      }\r\n        <div className=\"post-content\">\r\n          <ReactHTMLContent html={page.htmlAst}></ReactHTMLContent>\r\n          {\r\n            (page.fields.subscriberContent == null || page.fields.subscriberContent.length == 0) ?          \r\n            \"\"\r\n            : \r\n            <SubscriberFooter content={page.fields.subscriberContent}></SubscriberFooter> \r\n          }\r\n        </div>\r\n        {\r\n          page.frontmatter.comments == true ? \r\n          <CommentFooter slug={page.frontmatter.slug} comments={this.props.context.comments}></CommentFooter> \r\n          : \"\"\r\n        }\r\n\r\n        {\r\n          page.frontmatter.footer.map((c,i) => (\r\n            <div key={i}>\r\n            {\r\n              mapFooterComponent(c, page, cat, this.props.context.author, stories, this.props.data.avatar, this.props.data.tags.edges.map(e => e.node))\r\n            }\r\n            </div>\r\n          ))\r\n        }\r\n      </ContentLayoutWithSidebar>\r\n    )\r\n  }\r\n}\r\n\r\nconst Page = ({data, pageContext, location}) => {\r\n  return (\r\n    <SpecialPageTemplate location={location} data={data} context={pageContext}></SpecialPageTemplate>\r\n  )\r\n}\r\nexport default Page;\r\n\r\nexport const pageQuery = graphql`\r\n  query SpecialPageById($id: String!, $avatar: String, $image: String!) {\r\n    page: markdownRemark(\r\n      id: { eq: $id }\r\n      fileAbsolutePath: {\r\n        regex: \"/.*\\/data\\/pages\\/.*[.]md/\"\r\n      }\r\n    )\r\n    {\r\n      ...specialPage\r\n    }\r\n    avatar: file(\r\n    \tabsolutePath: { regex: \"/.*\\/data\\/img\\/*/\"}  \r\n      name:{ eq: $avatar}\r\n    ){\r\n      childImageSharp {\r\n        fixed(width: 100, height: 100) {\r\n          ...GatsbyImageSharpFixed\r\n        }\r\n      }\r\n    }\r\n    image: file(\r\n    \tabsolutePath: { eq: $image}  \r\n      name:{ eq: $avatar}\r\n    ){\r\n      childImageSharp {\r\n        fluid(maxWidth: 500, maxHeight: 500) {\r\n          ...GatsbyImageSharpFluid\r\n        }\r\n      }\r\n    }\r\n    ...categories\r\n    ...customerStories\r\n    ...tags\r\n}\r\n`;\r\n"],"sourceRoot":""}